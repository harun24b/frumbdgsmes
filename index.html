
<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Egg Farm Invest</title>
<style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');
    :root { --bg-color: linear-gradient(160deg, #0b0c17, #1c1f2a); --card-bg-color: rgba(255,255,255,0.05); --primary-text-color: #ffffff; --accent-color: #facc15; --timer-color: #38bdf8; --font-family: 'Poppins', sans-serif; --glow-color: #facc15; --danger-color: #ef4444; }
    body { margin: 0; padding: 0; font-family: var(--font-family); background: var(--bg-color); color: var(--primary-text-color); }
    .container { padding: 10px; max-width: 500px; margin: 0 auto; padding-bottom: 100px; }
    .hide { display: none; }
    .auth-container { background: var(--card-bg-color); border-radius: 25px; padding: 30px; margin-top: 80px; text-align: center; box-shadow: 0 0 25px rgba(250,204,21,0.6); backdrop-filter: blur(10px); }
    .auth-container h1 { color: var(--accent-color); text-shadow: 0 0 10px var(--glow-color); }
    .auth-tabs { display: flex; justify-content: center; margin-bottom: 20px; }
    .tab { flex: 1; padding: 12px; cursor: pointer; color: #888; border-bottom: 2px solid transparent; font-weight: 600; }
    .tab.active { color: var(--accent-color); border-color: var(--accent-color); }
    input, select { width: 90%; padding: 14px; margin: 8px 0; border-radius: 12px; border: none; background: rgba(255,255,255,0.1); color: white; font-size: 16px; font-family: var(--font-family); }
    button, .button { width: 90%; padding: 12px; margin: 8px auto; border: none; border-radius: 30px; font-weight: bold; cursor: pointer; background-color: var(--accent-color); color: #000; box-shadow: 0 0 15px var(--glow-color); text-align: center; text-decoration: none; display: block; }
    button:disabled { background-color: rgba(128,128,128,0.2); color: #888; cursor: not-allowed; box-shadow: none; }
    #statusMsg { font-size: 14px; margin-top: 10px; color: var(--timer-color); }
    .game-header { text-align: center; margin-top: 20px; padding: 15px; background: var(--card-bg-color); border-radius: 20px; backdrop-filter: blur(8px); margin-bottom: 20px; }
    .game-header .stats { display: flex; justify-content: space-around; margin-top: 10px; }
    .game-header .stat span { color: var(--accent-color); font-weight: bold; }
    .card { background: var(--card-bg-color); border-radius: 20px; padding: 18px; margin-bottom: 15px; text-align: center; backdrop-filter: blur(8px); }
    .item-title { font-size: 20px; font-weight: bold; }
    .item-icon { font-size: 50px; }
    .action-button { background-color: rgba(250,204,21,0.2); color: var(--accent-color); }
    .action-button:disabled { background-color: rgba(128,128,128,0.2); color: #888; cursor: not-allowed; }
    .info-text { margin: 5px 0; }
    .info-text span { color: var(--timer-color); font-weight: bold; }
    .nav-bar { display: flex; justify-content: space-around; padding: 12px 0; background: rgba(0,0,0,0.3); backdrop-filter: blur(10px); position: fixed; bottom: 0; width: 100%; max-width: 500px; left: 50%; transform: translateX(-50%); z-index: 100; }
    .nav-btn { width: 65px; height: 65px; border-radius: 50%; border: none; font-size: 12px; background-color: rgba(255,255,255,0.05); color: #ccc; cursor: pointer; display: flex; flex-direction: column; justify-content: center; align-items: center; }
    .nav-btn.active { background: var(--accent-color); color: #000; font-weight: bold; }
    .logout-btn { background: var(--danger-color); color: white; margin-top: 15px; }
    #nurseryList p { margin: 5px 0; }
    .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.7); display: none; justify-content: center; align-items: center; z-index: 1000; }
    .modal-content { background: #1c1f2a; padding: 25px; border-radius: 15px; text-align: center; width: 80%; max-width: 350px; box-shadow: 0 0 20px rgba(250, 204, 21, 0.5); border: 1px solid var(--accent-color); }
    .modal-content p { margin: 0 0 20px 0; color: var(--primary-text-color); font-size: 16px; }
    .modal-content button { width: 100px; padding: 10px; margin: 0 auto; border: none; border-radius: 20px; font-weight: bold; cursor: pointer; background-color: var(--accent-color); color: #000; display: block; }
</style>

<!-- ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ SDK ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá -->
<script src='//libtl.com/sdk.js' data-zone='10140813' data-sdk='show_10140813'></script>

</head>
<body>

<!-- Login/Signup Page -->
<div class="container" id="loginPage">
  <div class="auth-container">
    <h1>Egg Farm Invest</h1>
    <div class="auth-tabs">
      <div id="loginTab" class="tab active" onclick="switchTab('login')">‡¶≤‡¶ó‡¶á‡¶®</div>
      <div id="signupTab" class="tab" onclick="switchTab('signup')">‡¶∏‡¶æ‡¶á‡¶® ‡¶Ü‡¶™</div>
    </div>
    <div id="loginForm">
        <input type="email" id="loginEmail" placeholder="‡¶á‡¶Æ‡ßá‡¶á‡¶≤">
        <input type="password" id="loginPassword" placeholder="‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°">
        <button onclick="handleLogin()">‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</button>
    </div>
    <div id="signupForm" class="hide">
        <input type="email" id="signupEmail" placeholder="‡¶á‡¶Æ‡ßá‡¶á‡¶≤">
        <input type="password" id="signupPassword" placeholder="‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°">
        <input type="password" id="signupConfirmPassword" placeholder="‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶ï‡¶∞‡ßÅ‡¶®">
        <button onclick="handleSignup()">‡¶∏‡¶æ‡¶á‡¶® ‡¶Ü‡¶™ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
    </div>
    <p id="statusMsg"></p>
  </div>
</div>

<!-- Game Page -->
<div class="container hide" id="gamePage">
    <div class="game-header">
        <h2 id="welcomeMsg"></h2>
        <div class="stats">
            <div class="stat">üí∞ ‡¶ü‡¶æ‡¶ï‡¶æ: <span id="moneyDisplay">0</span></div>
            <div class="stat">ü•ö ‡¶°‡¶ø‡¶Æ: <span id="eggDisplay">0</span></div>
        </div>
    </div>
    <!-- Home View -->
    <div id="homeView">
        <a id="telegramLink" href="#" target="_blank" class="button hide" style="background-color: #2AABEE; color: white; margin-bottom: 15px;">‡¶ü‡ßá‡¶≤‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ ‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤‡ßá ‡¶Ø‡ßã‡¶ó ‡¶¶‡¶ø‡¶®</a>
        
        <div id="adRewardView" class="card">
            <div class="item-icon">üì∫</div>
            <div class="item-title">‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶® ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®</div>
            <p class="info-text">‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶® ‡¶¶‡ßá‡¶ñ‡ßá ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶Ü‡ßü ‡¶ï‡¶∞‡ßÅ‡¶®!</p>
            <button id="watchAdBtn" onclick="watchAdForReward()">‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶® ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®</button>
            <p class="info-text"><span id="adTimer"></span></p>
        </div>

        <div id="nurseryView" class="card">
            <div class="item-icon">üê£</div>
            <div class="item-title">‡¶á‡¶®‡¶ï‡¶ø‡¶â‡¶¨‡ßá‡¶ü‡¶∞</div>
            <div id="nurseryList"></div>
        </div>
        <div class="card">
            <div class="item-icon">ü¶¢</div>
            <div class="item-title">‡¶∞‡¶æ‡¶ú‡¶π‡¶æ‡¶Å‡¶∏</div>
            <p class="info-text">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ï‡¶æ‡¶õ‡ßá ‡¶Ü‡¶õ‡ßá: <span id="swanCount">0</span> ‡¶ü‡¶ø</p>
            <p class="info-text">‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞ ‡¶Ü‡¶õ‡ßá: <span id="swanFoodCount">0</span> ‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ü</p>
            <button class="action-button" onclick="collectEggs('swan')" id="collectSwanEggBtn" disabled>‡¶°‡¶ø‡¶Æ ‡¶∏‡¶Ç‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßÅ‡¶®</button>
            <p class="info-text">‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‡¶°‡¶ø‡¶Æ: <span id="swanTimer">--:--</span></p>
        </div>
        <div class="card">
            <div class="item-icon">ü¶ú</div>
            <div class="item-title">‡¶ü‡¶ø‡¶Ø‡¶º‡¶æ ‡¶™‡¶æ‡¶ñ‡¶ø</div>
            <p class="info-text">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ï‡¶æ‡¶õ‡ßá ‡¶Ü‡¶õ‡ßá: <span id="parrotCount">0</span> ‡¶ü‡¶ø</p>
            <p class="info-text">‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞ ‡¶Ü‡¶õ‡ßá: <span id="parrotFoodCount">0</span> ‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ü</p>
            <button class="action-button" onclick="collectEggs('parrot')" id="collectParrotEggBtn" disabled>‡¶°‡¶ø‡¶Æ ‡¶∏‡¶Ç‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßÅ‡¶®</button>
            <p class="info-text">‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‡¶°‡¶ø‡¶Æ: <span id="parrotTimer">--:--</span></p>
        </div>
         <button class="logout-btn" onclick="logout()">‡¶≤‡¶ó ‡¶Ü‡¶â‡¶ü</button>
    </div>
    <!-- Shop View -->
    <div id="shopView" class="hide">
        <div class="card">
            <div class="item-icon">ü¶¢</div>
            <div class="item-title">‡¶∞‡¶æ‡¶ú‡¶π‡¶æ‡¶Å‡¶∏‡ßá‡¶∞ ‡¶¨‡¶æ‡¶ö‡ßç‡¶ö‡¶æ</div>
            <p class="info-text">‡¶¶‡¶æ‡¶Æ: <span id="babySwanPrice">0</span> ‡¶ü‡¶æ‡¶ï‡¶æ</p>
            <button class="button" onclick="buyItem('babySwan')">‡¶ï‡¶ø‡¶®‡ßÅ‡¶®</button>
        </div>
         <div class="card">
            <div class="item-icon">ü¶ú</div>
            <div class="item-title">‡¶ü‡¶ø‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶¨‡¶æ‡¶ö‡ßç‡¶ö‡¶æ</div>
            <p class="info-text">‡¶¶‡¶æ‡¶Æ: <span id="babyParrotPrice">0</span> ‡¶ü‡¶æ‡¶ï‡¶æ</p>
            <button class="button" onclick="buyItem('babyParrot')">‡¶ï‡¶ø‡¶®‡ßÅ‡¶®</button>
        </div>
        <div class="card">
            <div class="item-icon">üç≤</div>
            <div class="item-title">‡¶∞‡¶æ‡¶ú‡¶π‡¶æ‡¶Å‡¶∏‡ßá‡¶∞ ‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞</div>
            <p class="info-text">‡¶¶‡¶æ‡¶Æ: <span id="swanFoodPrice">0</span> ‡¶ü‡¶æ‡¶ï‡¶æ</p>
            <button class="button" onclick="buyItem('swanFood')">‡¶ï‡¶ø‡¶®‡ßÅ‡¶®</button>
        </div>
         <div class="card">
            <div class="item-icon">ü•ú</div>
            <div class="item-title">‡¶ü‡¶ø‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞</div>
            <p class="info-text">‡¶¶‡¶æ‡¶Æ: <span id="parrotFoodPrice">0</span> ‡¶ü‡¶æ‡¶ï‡¶æ</p>
            <button class="button" onclick="buyItem('parrotFood')">‡¶ï‡¶ø‡¶®‡ßÅ‡¶®</button>
        </div>
    </div>
    <!-- Market View -->
    <div id="marketView" class="hide">
        <div class="card">
            <div class="item-icon">ü•ö</div>
            <div class="item-title">‡¶°‡¶ø‡¶Æ‡ßá‡¶∞ ‡¶¨‡¶æ‡¶ú‡¶æ‡¶∞</div>
            <p class="info-text">‡¶∞‡¶æ‡¶ú‡¶π‡¶æ‡¶Å‡¶∏‡ßá‡¶∞ ‡¶°‡¶ø‡¶Æ ‡¶Ü‡¶õ‡ßá: <span id="swanEggCount">0</span> ‡¶ü‡¶ø</p>
            <p class="info-text">‡¶ü‡¶ø‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶°‡¶ø‡¶Æ ‡¶Ü‡¶õ‡ßá: <span id="parrotEggCount">0</span> ‡¶ü‡¶ø</p>
            <button class="button" onclick="sellAllEggs()">‡¶∏‡¶¨ ‡¶°‡¶ø‡¶Æ ‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®</button>
        </div>
    </div>
    <!-- Cashout View -->
    <div id="cashoutView" class="hide">
        <div class="card">
            <div class="item-icon">üí∏</div>
            <div class="item-title">‡¶ü‡¶æ‡¶ï‡¶æ ‡¶â‡¶§‡ßç‡¶§‡ßã‡¶≤‡¶®</div>
            <p class="info-text">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏: <span id="cashoutBalance">0</span> ‡¶ü‡¶æ‡¶ï‡¶æ</p>
            <select id="paymentMethod">
                <option value="bKash">‡¶¨‡¶ø‡¶ï‡¶æ‡¶∂</option>
                <option value="Nagad">‡¶®‡¶ó‡¶¶</option>
                <option value="Rocket">‡¶∞‡¶ï‡ßá‡¶ü</option>
            </select>
            <input type="text" id="accountDetails" placeholder="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶¶‡¶ø‡¶®">
            <input type="number" id="cashoutAmount" placeholder="‡¶ü‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£ ‡¶¶‡¶ø‡¶®">
            <button class="button" onclick="requestCashOut()">‡¶∞‡¶ø‡¶ï‡ßÅ‡ßü‡ßá‡¶∏‡ßç‡¶ü ‡¶™‡¶æ‡¶†‡¶æ‡¶®</button>
        </div>
    </div>

    <!-- Navigation Bar -->
    <div class="nav-bar">
        <button id="navHome" class="nav-btn active" onclick="showGameView('home')">üè†<br>‡¶´‡¶æ‡¶∞‡ßç‡¶Æ</button>
        <button id="navShop" class="nav-btn" onclick="showGameView('shop')">üõí<br>‡¶∂‡¶™</button>
        <button id="navMarket" class="nav-btn" onclick="showGameView('market')">üìà<br>‡¶Æ‡¶æ‡¶∞‡ßç‡¶ï‡ßá‡¶ü</button>
        <button id="navCashout" class="nav-btn" onclick="showGameView('cashout')">üí∏<br>‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂ ‡¶Ü‡¶â‡¶ü</button>
    </div>
</div>

<!-- Custom Alert Modal -->
<div id="customAlertModal" class="modal-overlay">
    <div class="modal-content">
        <p id="customAlertMessage"></p>
        <button onclick="closeCustomAlert()">‡¶†‡¶ø‡¶ï ‡¶Ü‡¶õ‡ßá</button>
    </div>
</div>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyCs89Peo98U8n8VpYoYvELZufYRntYwJ7Y",
  authDomain: "frumgames.firebaseapp.com",
  databaseURL: "https://frumgames-default-rtdb.firebaseio.com",
  projectId: "frumgames",
  storageBucket: "frumgames.firebasestorage.app",
  messagingSenderId: "676354256457",
  appId: "1:676354256457:web:12bab00d1c76a5eee81998"
};

firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.database();

let currentUserData = null;
let gameSettings = {};
let gameInterval;
const ADMIN_EMAIL = "Harun123@gmail.com";

// ### ‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® (‡¶ï‡ßã‡¶®‡ßã ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶®‡ßá‡¶á) ###
function customAlert(message) { document.getElementById('customAlertMessage').textContent = message; document.getElementById('customAlertModal').style.display = 'flex'; }
function closeCustomAlert() { document.getElementById('customAlertModal').style.display = 'none'; }
function switchTab(tabName) { document.getElementById('loginTab').classList.toggle('active', tabName === 'login'); document.getElementById('signupTab').classList.toggle('active', tabName === 'signup'); document.getElementById('loginForm').classList.toggle('hide', tabName !== 'login'); document.getElementById('signupForm').classList.toggle('hide', tabName !== 'signup'); }
auth.onAuthStateChanged(user => { if (user && user.email !== ADMIN_EMAIL) { loadGameDataForUser(user.uid); } else { showLoginPage(); if(gameInterval) clearInterval(gameInterval); } });
function handleLogin() { const email = document.getElementById('loginEmail').value; const password = document.getElementById('loginPassword').value; const msg = document.getElementById('statusMsg'); msg.textContent = "‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá..."; auth.signInWithEmailAndPassword(email, password).catch(error => msg.textContent = "‡¶≠‡ßÅ‡¶≤ ‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶¨‡¶æ ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°‡•§"); }
function handleSignup() { const email = document.getElementById('signupEmail').value; const password = document.getElementById('signupPassword').value; const confirmPassword = document.getElementById('signupConfirmPassword').value; const msg = document.getElementById('statusMsg'); if (password !== confirmPassword) { msg.textContent = "‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶Æ‡ßá‡¶≤‡ßá‡¶®‡¶ø‡•§"; return; } msg.textContent = "‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá..."; auth.createUserWithEmailAndPassword(email, password).then(cred => initializeNewUserData(cred.user.uid, email)).catch(error => msg.textContent = error.message); }
function initializeNewUserData(userId, email) { db.ref('users/' + userId).set({ email: email, money: 100, eggs: { swan: 0, parrot: 0 }, animals: { swan: 0, parrot: 0 }, food: { swan: 0, parrot: 0 }, timers: { swanEgg: Date.now(), parrotEgg: Date.now(), lastAdWatch: 0 }, nursery: {} }); }
function logout() { auth.signOut(); }
function showLoginPage() { document.getElementById('loginPage').classList.remove('hide'); document.getElementById('gamePage').classList.add('hide'); }
function loadGameDataForUser(userId) { db.ref('gameSettings').on('value', snapshot => { if(snapshot.exists()) gameSettings = snapshot.val(); db.ref('users/' + userId).on('value', (snapshot) => { currentUserData = snapshot.val(); if(currentUserData){ document.getElementById('gamePage').classList.contains('hide') ? showGamePage() : updateUI(); } }); }); }
function showGamePage() { document.getElementById('loginPage').classList.add('hide'); document.getElementById('gamePage').classList.remove('hide'); updateUI(); if(gameInterval) clearInterval(gameInterval); gameInterval = setInterval(() => { eggLoop(); checkNursery(); updateAdCooldownTimer(); }, 1000); }
function updateUI() { if (!currentUserData) return; const d = currentUserData; const s = gameSettings || {}; document.getElementById('welcomeMsg').textContent = `‡¶∏‡ßç‡¶¨‡¶æ‡¶ó‡¶§‡¶Æ, ${d.email.split('@')[0]}`; document.getElementById('moneyDisplay').textContent = d.money; document.getElementById('eggDisplay').textContent = (d.eggs?.swan || 0) + (d.eggs?.parrot || 0); document.getElementById('cashoutBalance').textContent = d.money; const tgLink = document.getElementById('telegramLink'); if(s.telegramUrl && s.telegramUrl.length > 5) { tgLink.href = s.telegramUrl; tgLink.classList.remove('hide'); } else { tgLink.classList.add('hide'); } document.getElementById('swanCount').textContent = d.animals?.swan || 0; document.getElementById('swanFoodCount').textContent = d.food?.swan || 0; document.getElementById('parrotCount').textContent = d.animals?.parrot || 0; document.getElementById('parrotFoodCount').textContent = d.food?.parrot || 0; const shopSettings = s.shop || {}; document.getElementById('babySwanPrice').textContent = shopSettings.babySwan?.price || 0; document.getElementById('babyParrotPrice').textContent = shopSettings.babyParrot?.price || 0; document.getElementById('swanFoodPrice').textContent = shopSettings.swanFood?.price || 0; document.getElementById('parrotFoodPrice').textContent = shopSettings.parrotFood?.price || 0; document.getElementById('swanEggCount').textContent = d.eggs?.swan || 0; document.getElementById('parrotEggCount').textContent = d.eggs?.parrot || 0; const nurseryListDiv = document.getElementById('nurseryList'); nurseryListDiv.innerHTML = ''; if (d.nursery && Object.keys(d.nursery).length > 0) { Object.values(d.nursery).forEach(baby => { const timeLeft = Math.max(0, baby.readyTime - Date.now()); nurseryListDiv.innerHTML += `<p class="info-text">‡¶è‡¶ï‡¶ü‡¶ø ${baby.type === 'swan' ? '‡¶∞‡¶æ‡¶ú‡¶π‡¶æ‡¶Å‡¶∏' : '‡¶ü‡¶ø‡¶Ø‡¶º‡¶æ'} ‡¶¨‡ßú ‡¶π‡¶ö‡ßç‡¶õ‡ßá... <span>${new Date(timeLeft).toISOString().substr(14, 5)}</span></p>`; }); } else { nurseryListDiv.innerHTML = '<p class="info-text">‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶ï‡ßã‡¶®‡ßã ‡¶¨‡¶æ‡¶ö‡ßç‡¶ö‡¶æ ‡¶¨‡ßú ‡¶π‡¶ö‡ßç‡¶õ‡ßá ‡¶®‡¶æ‡•§</p>'; } }
function eggLoop() { if (!currentUserData) return; ['swan', 'parrot'].forEach(type => { const count = currentUserData.animals?.[type] || 0; const food = currentUserData.food?.[type] || 0; const animalSettings = gameSettings.animals?.[type] || {}; const eggTime = (animalSettings.boostedEggTime || 3600) * 1000; const timeLeft = Math.max(0, (currentUserData.timers?.[type + 'Egg'] || 0) + eggTime - Date.now()); const canCollect = count > 0 && food >= count && timeLeft <= 0; document.getElementById(`collect${type.charAt(0).toUpperCase() + type.slice(1)}EggBtn`).disabled = !canCollect; document.getElementById(`${type}Timer`).textContent = canCollect ? "‡¶∏‡¶Ç‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßÅ‡¶®!" : new Date(timeLeft).toISOString().substr(14, 5); }); }
function checkNursery() { if (!currentUserData?.nursery) return; const now = Date.now(); const updates = {}; let grownAnimalsAlerts = []; Object.entries(currentUserData.nursery).forEach(([key, baby]) => { if (now >= baby.readyTime) { updates[`/users/${auth.currentUser.uid}/animals/${baby.type}`] = (currentUserData.animals?.[baby.type] || 0) + 1; updates[`/users/${auth.currentUser.uid}/nursery/${key}`] = null; grownAnimalsAlerts.push(`‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶è‡¶ï‡¶ü‡¶ø ${baby.type === 'swan' ? '‡¶∞‡¶æ‡¶ú‡¶π‡¶æ‡¶Å‡¶∏‡ßá‡¶∞' : '‡¶ü‡¶ø‡¶Ø‡¶º‡¶æ‡¶∞'} ‡¶¨‡¶æ‡¶ö‡ßç‡¶ö‡¶æ ‡¶¨‡ßú ‡¶π‡ßü‡ßá ‡¶ó‡ßá‡¶õ‡ßá!`); } }); if (Object.keys(updates).length > 0) { db.ref().update(updates).then(() => { grownAnimalsAlerts.forEach(customAlert); }); } }
function buyItem(itemName) { const item = gameSettings.shop?.[itemName]; if(!item) { customAlert("‡¶¶‡ßã‡¶ï‡¶æ‡¶®‡ßá ‡¶è‡¶á ‡¶ú‡¶ø‡¶®‡¶ø‡¶∏‡¶ü‡¶ø ‡¶è‡¶ñ‡¶® ‡¶®‡ßá‡¶á‡•§"); return; } if (currentUserData.money < item.price) { customAlert("‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ø‡¶•‡ßá‡¶∑‡ßç‡¶ü ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶®‡ßá‡¶á!"); return; } const userRef = db.ref('users/' + auth.currentUser.uid); const updates = {}; updates['/money'] = currentUserData.money - item.price; if (itemName.includes('Food')) { const type = itemName.replace('Food', ''); updates[`/food/${type}`] = (currentUserData.food?.[type] || 0) + 1; customAlert(`‡ßß ‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ü ${type === 'swan' ? '‡¶∞‡¶æ‡¶ú‡¶π‡¶æ‡¶Å‡¶∏‡ßá‡¶∞' : '‡¶ü‡¶ø‡¶Ø‡¶º‡¶æ‡¶∞'} ‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞ ‡¶ï‡ßá‡¶®‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá!`); } else { const type = itemName.replace('baby', '').toLowerCase(); const growthTime = item.growthTime * 1000; const newBabyRef = userRef.child('nursery').push(); updates[`/nursery/${newBabyRef.key}`] = { type, readyTime: Date.now() + growthTime }; customAlert(`‡¶¨‡¶æ‡¶ö‡ßç‡¶ö‡¶æ‡¶ü‡¶ø ‡¶á‡¶®‡¶ï‡¶ø‡¶â‡¶¨‡ßá‡¶ü‡¶∞‡ßá ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá!`); } userRef.update(updates); }
function collectEggs(animalType) { const count = currentUserData.animals?.[animalType] || 0; const food = currentUserData.food?.[animalType] || 0; if (count > 0 && food >= count) { const updates = { [`/food/${animalType}`]: food - count, [`/eggs/${animalType}`]: (currentUserData.eggs?.[animalType] || 0) + count, [`/timers/${animalType}Egg`]: Date.now() }; db.ref('users/' + auth.currentUser.uid).update(updates); customAlert(`${count} ‡¶ü‡¶ø ‡¶°‡¶ø‡¶Æ ‡¶∏‡¶Ç‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá!`); } else { customAlert("‡¶°‡¶ø‡¶Æ ‡¶∏‡¶Ç‡¶ó‡ßç‡¶∞‡¶π‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ø‡¶•‡ßá‡¶∑‡ßç‡¶ü ‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞ ‡¶®‡ßá‡¶á‡•§"); } }
function sellAllEggs() { const swanEggValue = gameSettings.animals?.swan?.eggValue || 0; const parrotEggValue = gameSettings.animals?.parrot?.eggValue || 0; const swanEarnings = (currentUserData.eggs?.swan || 0) * swanEggValue; const parrotEarnings = (currentUserData.eggs?.parrot || 0) * parrotEggValue; const totalEarnings = swanEarnings + parrotEarnings; if (totalEarnings > 0) { db.ref('users/' + auth.currentUser.uid).update({ '/money': currentUserData.money + totalEarnings, '/eggs/swan': 0, '/eggs/parrot': 0 }); customAlert(`${totalEarnings} ‡¶ü‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶°‡¶ø‡¶Æ ‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡¶ø ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá!`); } else { customAlert("‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡¶ø ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶Æ‡¶§‡ßã ‡¶ï‡ßã‡¶®‡ßã ‡¶°‡¶ø‡¶Æ ‡¶®‡ßá‡¶á‡•§"); } }
function requestCashOut() { const amount = parseInt(document.getElementById('cashoutAmount').value); const paymentMethod = document.getElementById('paymentMethod').value; const accountDetails = document.getElementById('accountDetails').value; const userId = auth.currentUser.uid; if (!amount || amount <= 0) { customAlert("‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶∏‡¶†‡¶ø‡¶ï ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®‡•§"); return; } if (amount > currentUserData.money) { customAlert("‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡ßá ‡¶Ø‡¶•‡ßá‡¶∑‡ßç‡¶ü ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶®‡ßá‡¶á‡•§"); return; } if (!accountDetails) { customAlert("‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶¶‡¶ø‡¶®‡•§"); return; } const newRequestKey = db.ref('cashoutRequests').push().key; const newBalance = currentUserData.money - amount; const updates = {}; updates[`/users/${userId}/money`] = newBalance; updates[`/cashoutRequests/${newRequestKey}`] = { userId: userId, userEmail: auth.currentUser.email, amount: amount, paymentMethod: paymentMethod, accountDetails: accountDetails, status: 'pending', timestamp: Date.now() }; db.ref().update(updates).then(() => { customAlert("‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶â‡¶§‡ßç‡¶§‡ßã‡¶≤‡¶®‡ßá‡¶∞ ‡¶Ö‡¶®‡ßÅ‡¶∞‡ßã‡¶ß‡¶ü‡¶ø ‡¶ó‡ßç‡¶∞‡¶π‡¶£ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§"); document.getElementById('cashoutAmount').value = ''; document.getElementById('accountDetails').value = ''; showGameView('home'); }).catch(error => { customAlert("‡¶è‡¶ï‡¶ü‡¶ø ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§ ‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§"); }); }
function showGameView(viewName) { ['home', 'shop', 'market', 'cashout'].forEach(v => { document.getElementById(v + 'View').classList.add('hide'); document.getElementById('nav' + v.charAt(0).toUpperCase() + v.slice(1)).classList.remove('active'); }); document.getElementById(viewName + 'View').classList.remove('hide'); document.getElementById('nav' + viewName.charAt(0).toUpperCase() + viewName.slice(1)).classList.add('active'); }

// ===========================================
// ### ‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶® ‡¶∞‡¶ø‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°‡ßá‡¶∞ ‡¶∏‡¶Ç‡¶∂‡ßã‡¶ß‡¶ø‡¶§ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® ###
// ===========================================

function updateAdCooldownTimer() {
    if (!currentUserData) return;

    // ‡¶°‡¶æ‡¶ü‡¶æ‡¶¨‡ßá‡¶∏ ‡¶•‡ßá‡¶ï‡ßá ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏ ‡¶®‡¶æ ‡¶™‡ßá‡¶≤‡ßá‡¶ì ‡¶Ø‡ßá‡¶® ‡¶ï‡ßã‡¶° ‡¶¨‡¶®‡ßç‡¶ß ‡¶®‡¶æ ‡¶π‡ßü
    const rewardsSettings = gameSettings.rewards || {};
    const adBtn = document.getElementById('watchAdBtn');
    const adTimerSpan = document.getElementById('adTimer');
    
    // ‡¶°‡¶ø‡¶´‡¶≤‡ßç‡¶ü ‡¶Æ‡¶æ‡¶® ‡¶π‡¶ø‡¶∏‡ßá‡¶¨‡ßá ‡ß©‡ß¶‡ß¶ ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶° (‡ß´ ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü) ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá
    const cooldown = (rewardsSettings.adCooldownSeconds || 300) * 1000;
    const lastWatch = currentUserData.timers?.lastAdWatch || 0;
    const nextAdTime = lastWatch + cooldown;
    const timeLeft = Math.max(0, nextAdTime - Date.now());

    if (timeLeft > 0) {
        adBtn.disabled = true;
        const minutes = Math.floor(timeLeft / 60000);
        const seconds = Math.floor((timeLeft % 60000) / 1000);
        adTimerSpan.textContent = `‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶®: ${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
    } else {
        adBtn.disabled = false;
        adTimerSpan.textContent = "‡¶è‡¶ñ‡¶® ‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶® ‡¶¶‡ßá‡¶ñ‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶¨‡ßá‡¶®!";
    }
}

function watchAdForReward() {
    // ‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶® SDK ‡¶≤‡ßã‡¶° ‡¶π‡ßü‡ßá‡¶õ‡ßá ‡¶ï‡¶ø‡¶®‡¶æ ‡¶§‡¶æ ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá
    if (typeof show_10140813 !== 'function') {
        customAlert("‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶® ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø‡•§ ‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶™‡ßÉ‡¶∑‡ßç‡¶†‡¶æ‡¶ü‡¶ø ‡¶∞‡¶ø‡¶´‡ßç‡¶∞‡ßá‡¶∂ ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶Ö‡¶•‡¶¨‡¶æ ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°-‡¶¨‡ßç‡¶≤‡¶ï‡¶æ‡¶∞ ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®‡•§");
        console.error("Ad SDK function 'show_10140813' is not available.");
        return;
    }

    const rewardsSettings = gameSettings.rewards || {};
    const cooldown = (rewardsSettings.adCooldownSeconds || 300) * 1000;
    const rewardAmount = rewardsSettings.adRewardAmount || 50; // ‡¶°‡¶ø‡¶´‡¶≤‡ßç‡¶ü ‡¶™‡ßÅ‡¶∞‡¶∏‡ßç‡¶ï‡¶æ‡¶∞ ‡ß´‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ
    const lastWatch = currentUserData.timers?.lastAdWatch || 0;

    if (Date.now() < lastWatch + cooldown) {
        customAlert("‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶®‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§");
        return;
    }

    // ‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶® ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã ‡¶π‡¶ö‡ßç‡¶õ‡ßá
    show_10140813('pop').then(() => {
        // ‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶® ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶¶‡ßá‡¶ñ‡¶≤‡ßá
        const userRef = db.ref('users/' + auth.currentUser.uid);
        const updates = {
            'money': currentUserData.money + rewardAmount,
            'timers/lastAdWatch': Date.now()
        };

        userRef.update(updates).then(() => {
            customAlert(`‡¶Ö‡¶≠‡¶ø‡¶®‡¶®‡ßç‡¶¶‡¶®! ‡¶Ü‡¶™‡¶®‡¶ø ${rewardAmount} ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶™‡ßá‡ßü‡ßá‡¶õ‡ßá‡¶®!`);
        });

    }).catch(e => {
        // ‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶® ‡¶¶‡ßá‡¶ñ‡¶æ‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶≤‡ßá
        customAlert("‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶® ‡¶¶‡ßá‡¶ñ‡¶æ‡¶§‡ßá ‡¶è‡¶ï‡¶ü‡¶ø ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§ ‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§");
        console.error("Ad SDK error:", e);
    });
}
</script>
</body>
</html>
